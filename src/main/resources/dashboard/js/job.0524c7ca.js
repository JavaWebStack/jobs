"use strict";(self["webpackChunkdashboard"]=self["webpackChunkdashboard"]||[]).push([[569],{2505:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});var a=s(3396),n=s(7139);const i={class:"card border-secondary mb-3"},o={class:"card-header"},d={class:"card-body"},l={class:"card-title"},r={class:"card-text"},c=["innerHTML"],v={class:"card border-secondary mb-3"},h=(0,a._)("div",{class:"card-header"},"History",-1),b={class:"card-body"};function u(e,t,s,u,g,p){const _=(0,a.up)("job-event-box");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",i,[(0,a._)("div",o,[(0,a._)("h2",null,"Job - "+(0,n.zw)(g.job.id),1)]),(0,a._)("div",d,[(0,a._)("h4",l,(0,n.zw)(g.job.type),1),(0,a._)("p",r,[(0,a._)("pre",{innerHTML:JSON.stringify(g.payload,null,2)},null,8,c)])])]),(0,a._)("div",v,[h,(0,a._)("div",b,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.events,(e=>((0,a.wg)(),(0,a.j4)(_,{key:e.id,event:e},null,8,["event"])))),128))])])])}var g=s(8332);const p=e=>((0,a.dD)("data-v-653b88e2"),e=e(),(0,a.Cn)(),e),_={class:"summary"},y={class:"float-end"},f={key:0,class:"text-center"},w=p((()=>(0,a._)("div",{class:"spinner-border",role:"status"},[(0,a._)("span",{class:"visually-hidden"},"Loading...")],-1))),m=[w],j={key:1},D={style:{"padding-right":"20px","vertical-align":"top"}},E=["innerHTML"],k={key:2},J=p((()=>(0,a._)("small",null,"No logs to display",-1))),C=[J];function L(e,t,s,i,o,d){return(0,a.wg)(),(0,a.iD)("div",{class:(0,n.C_)(["event-box",{active:o.active,[`event-type-${s.event.type.toLowerCase()}`]:!0}])},[(0,a._)("div",{class:"event-box-header",onClick:t[0]||(t[0]=e=>d.toggleActive())},[(0,a._)("div",_,[(0,a.Uk)((0,n.zw)(o.eventTitles[s.event.type]||"Unknown")+" ",1),(0,a._)("span",y,(0,n.zw)(s.event.created_at),1)])]),(0,a._)("div",{class:(0,n.C_)(["collapse event-box-content",{show:o.active}])},[o.loading?((0,a.wg)(),(0,a.iD)("div",f,m)):o.logs.length>0?((0,a.wg)(),(0,a.iD)("table",j,[(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.logs,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",D,[(0,a._)("pre",null,(0,n.zw)(e.created_at),1)]),(0,a._)("td",null,[(0,a._)("code",{innerHTML:e.message},null,8,E)])])))),128))])])):((0,a.wg)(),(0,a.iD)("i",k,C))],2)],2)}var x={name:"JobEventBox",props:{event:{type:Object}},data(){return{active:!1,logs:[],loading:!1,eventTitles:{SCHEDULED:"Job scheduled",ENQUEUED:"Job enqueued",PROCESSING:"Processing job",FAILED:"Job processing failed",SUCCESS:"Job processing succeeded"}}},methods:{toggleActive(){this.active=!this.active,this.active?this.fetchLogs():this.logs=[]},fetchLogs(){this.loading=!0,g.Z.get("/jobs/"+this.event.job_id+"/events/"+this.event.id+"/logs").then((e=>{this.logs=e.data.data,this.loading=!1}))}}},T=s(89);const H=(0,T.Z)(x,[["render",L],["__scopeId","data-v-653b88e2"]]);var S=H,U={name:"Job",components:{JobEventBox:S},data(){return{job:{id:this.$route.params.id,type:""},payload:{},events:[],refreshTimer:void 0}},created(){this.fetchJob(!0),this.fetchEvents(),this.refreshTimer=setInterval(this.fetchJob,3e3)},beforeUnmount(){clearInterval(this.refreshTimer)},methods:{fetchJob(e=!1){g.Z.get("/jobs/"+this.job.id,{params:{payload:!0}}).then((t=>{this.job.status!==t.data.data.status&&this.fetchEvents(),e&&(this.payload=t.data.data.payload),this.job=t.data.data}),(()=>{this.$router.push({name:"jobs"})}))},fetchEvents(){g.Z.get("/jobs/"+this.job.id+"/events").then((e=>this.events=e.data.data))}}};const z=(0,T.Z)(U,[["render",u]]);var I=z}}]);
//# sourceMappingURL=job.0524c7ca.js.map